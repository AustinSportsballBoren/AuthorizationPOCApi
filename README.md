# How To Create A New Kubernetes Service And Deploy It To Azure

## Creating Your K8s Service
Run `dotnet new ndk8service -S <SOOSProjectName> -n <ServiceName>` to generate a new template service.
Navigate to the directory created by the above command.

## Creating Your gitfiles
Run `dotnet new ndgitfiles` to include a .gitattribues and .gitignore inside of your project.

## Setting Up docker-compose
Run `dotnet new nddockercompose` to generate docker-compose files inside of your project.

## Pushing Your Newly Generated Service Repository to GitHub
Create and push your new service repository to GitHub.

## Run Terraform
Run the required terraform to generate all of the required resources in Azure for your kubernetes service (if not done already).

## Generating Your Deployment Pipelines
Run `dotnet new ndk8scripts` to generate the required scripts to create pipelines for your service.
Run the `create-build-pipeline.sh` script (which should have been generated by the above command) to generate the required build and deployment pipelines in ADO for your service.

## Create K8 Service Connection Via Script
TODO

## Run Build/Deployment Pipeline
Ensure the variables in your deployment pipeline contain the correct values for fields such as `devAKS` `namespace` and `stackName`. 
Run your Build/Deployment pipeline.

## Viewing Your Deployed Service
After deploying your kubernetes service you will need to modify your hosts file to map the application gateway IP of the stack to your namespace ingress domain name.

For Example:
`20.106.82.248 ajb-dev.netdocuments.com`

You can then hit the service externally using that domain name.